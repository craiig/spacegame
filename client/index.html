<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script src="/events.js"></script>
<script src="/network.js"></script>
<script src="/world.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script src="/three/three.min.js"></script>
<script src="/three/Tween.js"></script>

<script>






function initParticle( particle, delay ) {

				var particle = this instanceof THREE.Particle ? this : particle;
				var delay = delay !== undefined ? delay : 0;

				particle.position.x = 0;
				particle.position.y = 0;
				particle.position.z = 0;
				particle.scale.x = particle.scale.y = Math.random() * 3 + 1;

				new TWEEN.Tween( particle )
					.delay( delay )
					.to( {}, 10000 )
					.onComplete( initParticle )
					.start();

				new TWEEN.Tween( particle.position )
					.delay( delay )
					.to( { x: Math.random() * 4000 - 2000, y: Math.random() * 1000 - 500, z: Math.random() * 4000 - 2000 }, 10000 )
					.start();

				new TWEEN.Tween( particle.scale )
					.delay( delay )
					.to( { x: 0, y: 0 }, 10000 )
					.start();

			}
function generateSprite() {

				var canvas = document.createElement( 'canvas' );
				canvas.width = 16;
				canvas.height = 16;

				var context = canvas.getContext( '2d' );
				var gradient = context.createRadialGradient( canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width / 2 );
				gradient.addColorStop( 0, 'rgba(255,255,255,1)' );
				gradient.addColorStop( 0.2, 'rgba(0,255,255,1)' );
				gradient.addColorStop( 0.4, 'rgba(0,0,64,1)' );
				gradient.addColorStop( 1, 'rgba(0,0,0,1)' );

				context.fillStyle = gradient;
				context.fillRect( 0, 0, canvas.width, canvas.height );

				return canvas;

			}
function init() {

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 5000 );
				camera.position.z = 1000;

				scene = new THREE.Scene();

				var material = new THREE.ParticleBasicMaterial( { map: new THREE.Texture( generateSprite() ), blending: THREE.AdditiveBlending } );

				for ( var i = 0; i < 1000; i++ ) {

					particle = new THREE.Particle( material );

					initParticle( particle, i * 10 );

					scene.add( particle );
				}

				renderer = new THREE.CanvasRenderer();
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.sortElements = false;
				renderer.setClearColorHex( 0x0000ff, 0.25 );
				container.appendChild( renderer.domElement );

				stats = new Stats();
				stats.domElement.style.position = 'absolute';
				stats.domElement.style.top = '0px';
				container.appendChild( stats.domElement );

				document.addEventListener( 'mousemove', onDocumentMouseMove, false );
				document.addEventListener( 'touchstart', onDocumentTouchStart, false );
				document.addEventListener( 'touchmove', onDocumentTouchMove, false );

				//

				window.addEventListener( 'resize', onWindowResize, false );

			}

function animate() {

				requestAnimationFrame( animate );

				render();
				stats.update();

			}

			function render() {

				TWEEN.update();

				camera.position.x += ( mouseX - camera.position.x ) * 0.05;
				camera.position.y += ( - mouseY - camera.position.y ) * 0.05;
				camera.lookAt( scene.position );

				renderer.render( scene, camera );

			}













  var lastPing = 0;

  //var socket = io.connect('http://192.168.1.105:59473');
  var socket = io.connect(location.hostname); //better way
  var world = new World(socket);

  //example: send a network obj rpc for testing
  world.socket.emit("network_objrpc", {objid:1,eventname:'attach_to_ship'});

  //send ping back immediately since we'll block processing and we can use it to measure how long this takes
  this.world.socket.emit('ping', { time: (new Date()).getTime() });

  //setup simple ping function
  $(document).ready( function(){ //fire when the document dom is ready
      socket.on('ping', function(data){
        //console.log("ping response:");
        //console.log(data);
        var now = (new Date()).getTime();
        $("#ping").html(now - data.time);
        //console.log("now: " + now + " received: " + data.time)
        lastPing = now;
        //this.emit('ping', { time: now });
      })
  })

//setup a keypress handler
$(document).bind('keydown', function(e){
  if(e.which == 38){
    //up key
    socket.emit('ship_accelerate_down');
    //console.log("down")
  } else if(e.which == 40){
    //down key
  } else if(e.which == 37){
    //left
    socket.emit('ship_accelerate_left');
  } else if(e.which == 39){
    //right
    socket.emit('ship_accelerate_right');
  }
  //console.log(e.which);
})

$(document).bind('keyup', function(e){
  if(e.which == 38){
    //up key
    socket.emit('ship_accelerate_up', "0")
    //console.log("up")
  } else if(e.which == 40){
    //down key
  } else if(e.which == 37){
    //left
  } else if(e.which == 39){
    //right
  }
  //console.log(e.which);
})

</script> 

Ping: <span id="ping">xx</span> ms
<br/>
<br/>
Ships: <ul id="shiplist"></ul>
<br/>
<br/>
Name: <input type="text" /> <br />
Players: <ul id="playerlist"></ul>

<svg id="svgelem" width="10cm" height="10cm" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 5000 5000"></svg>
<canvas id="example" width="5000" height="5000" >
This text is displayed if your browser does not support HTML5 Canvas.
</canvas>