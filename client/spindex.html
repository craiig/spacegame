<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
  var lastPing = 0;
  var socket = io.connect(location.hostname); //better way
  var worldObjects = Array();

  socket.on('objectlist', function(data){ //called on the first object push
    console.log("object list:");
    //console.log(data);

    //loop through all the messages in this update
    for (x in data){
        //check to see if this object has been added to world objects yet
        if (worldObjects.indexOf(x.netid)==-1) {
          worldObjects.push(x.netid);
        }
        //loop through all of the updated properties and assign to worldObject
        for (prop in x.data) {
          x=worldObjects[worldObjects.indexOf(x.netid)]
          x[prop[0]]=prop[1];
          worldObjects[worldObjects.indexOf(x.netid)]=x;
        }
    }
  });

  socket.on('objectupdate', function(data){ //called on the subsequent object push
      console.log("object update");
      
      for (x in data) {
        console.log(x.name + x);
        worldObjects[worldObjects.indexOf(x)]=x;
      }
    });

  $(document).ready( function(){ //fire when the document dom is ready
    
    for (x in worldObjects){
      console.log(x);
    };

  });

//setup a keypress handler
$(document).bind('keydown', function(e){
  //console.log('key' + e.which);
  if(e.which == 38){
    //up key
    socket.emit('ship_accelerate_down');
    //console.log("down")
  } else if(e.which == 40){
    //down key
  } else if(e.which == 37){
    //left
    socket.emit('ship_accelerate_left');
  } else if(e.which == 39){
    //right
    socket.emit('ship_accelerate_right');
  }
  //console.log(e.which);
});

$(document).bind('keyup', function(e){
  if(e.which == 38){
    //up key
    socket.emit('ship_accelerate_up', "0")
    //console.log("up")
  } else if(e.which == 40){
    //down key
  } else if(e.which == 37){
    //left
  } else if(e.which == 39){
    //right
  }
  //console.log(e.which);
});

</script> 
</head>
<body>
Ping: <span id="ping">xx</span> ms
</body>
</html>
